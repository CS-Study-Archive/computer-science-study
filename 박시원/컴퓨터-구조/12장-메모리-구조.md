
## [제 12장 Part-1](https://www.youtube.com/watch?v=fS0GkS7HtOY&list=PLc8fQ-m7b1hCHTT7VH2oo0Ng7Et096dYc&index=30)

### 메모리 계층 (Memory Hierachy)

#### 컴퓨터 시스템의 메모리 계층

- 레지스터
- 레벨 1 캐시
- 레벨 2, 3 캐시
- 메인 메모리
- 디스크(HDD/SSD, RAID)
- 백업 저장소(Tape, Drun) => 지금은 거의 쓰지 않음

#### 버스 인터페이스(CPU와의 연결 구조)

- 내부 버스로 연결
  - 레지스터, 캐시
- 외부 버스로 연결
  - 메인 메모리
  - (엄밀히 말하면 캐시도 외부 버스로 연결됨)
- 입출력 버스로 연결(IOP)
  - 디스크, 백업 저장소

### 주 기억 장치 (Main Memory)

#### 정의

- 컴퓨터가 동작하는 동안 데이터와 프로그램을 저장하는 곳
- 고속 저장 장치(메모리 상위 계층)
- RAM과 ROM을 합친 개념

#### RAM

- MOSFET binary refresh cell로 구성된 기억 장치
- 실행 가능한 프로그램을 저장
- 튜링 머신의 기억 장치에 해당
- 128 X 8 RAM => 8비트의 데이터를 128개 저장가능한 RAM
  - 8비트의 데이터를 사용하니 8비트 데이터 버스를 사용
  - 128이 2^7이므로 7비트 주소를 사용(7-bit address)

#### ROM

- EPROM, Flash RAM으로 구성
- BIOS, Bootstrap Code 저장

## [제 12장 Part-2](https://www.youtube.com/watch?v=VnFgmmzU-SQ&list=PLc8fQ-m7b1hCHTT7VH2oo0Ng7Et096dYc&index=31)

### 보조 기억 장치 (Auxiliary Memory)

- 자기 디스크(마그네틱 디스크) => HDD
- 자기 테이프(마그네틱 테이프)
  - 7~9bit(1 record)를 동시 기록
  - 지금은 RAID로 대체
  - RAID(Redundant Array of Independent Disks)

- 디스크 용량 = 섹터 수(512KB) X 트랙 수(N) X 헤드 수(2 ~ 4개)
- 디스크 성능(Access Time) = Seek Time + Rotation Delay + Transfer Time

### 어소시어티브 메모리 (Associative Memory)

- 메인 메모리는 주소 기반의 데이터 탐색인 반면, 어소시어티브 메모리는 내용 기반의 데이터 탐색임

### 캐시 메모리 (Cache Memory)

#### 특성

- 메인 메모리보다 10 ~ 100배 빠른 접근 속도
- 주 기억 장치보다 작은 용량을 가짐
- 캐시의 레벨 L1 ~ L2인 경우 CPU내부에 위치하고 L3는 CPU 내/외부에 위치함

#### 주소 맵핑

- 주 기억장치 주소 공간과 캐시 주소 공간과의 연결
- 맵핑 방식
  - 어소시어티브 맵핑
    - 캐시를 주소와 데이터 공간으로 분할
    - 데이터 저장 시 주소와 데이터 모두 저장
    - CPU 주소를 캐시의 주소와 비교
    - 어소시어티브 캐시의 경우 비싸서 큰 용량을 쓰지는 못함
  - 직접 맵핑
    - CPU 주소의 일부를 캐시 주소로 사용
    - 인덱스 값으로 캐시 접근
    - 태그를 통해서 데이터를 구분하여 맵핑함
  - 세트 어소시어티브 맵핑
    - 이름과는 달리 어소시어티브 맵핑과는 다르며, 오히려 직접 맵핑과 비슷함
    - Fully-Associative Mapping

#### 캐시에 기록

- CPU 데이터를 메모리와 캐시에 저장하는 구조
  - write-through => 캐시와 메모리에 동시 저장, 쓰기 속도 느림, 시스템 크래시 발생 시 데이터 안정성 높음
  - write-back => 캐시에 먼저 저장, 이후 버스 유휴 시간에 메모리로 기록, 쓰기 속도 빠름, 크래시 발생 시 데이터 손상 가능성 높음

#### 캐시 히트율

- CPU가 접근하는 데이터가 캐시에서 먼저 접근될 확률
- 일반적으로 85% ~ 95% => 설정 시 높게 설정함
- 캐시 미스율로 나타내기도 함(5% ~ 15%)

## [제 12장 Part-3](https://www.youtube.com/watch?v=ZepTkwWOk5s&list=PLc8fQ-m7b1hCHTT7VH2oo0Ng7Et096dYc&index=32)

### 가상 메모리 (Virtual Memory)

#### 개념

사용자에게 보조 메모리의 총량에 해당하는 대형 주소 공간을 제공

#### 주소 공간과 메모리 공간

- 가상 주소(Virtual Address): 프로그래머에 의하여 쓰여진 주소
- 주소 공간(Address Space): 가상 주소로 이루어진 공간
- 물리 주소(Physical Address): 주기억 장치의 주소
- 메모리 공간(Memory Space): 물리 주소로 이루어진 공간

#### 주소 맵핑

- 가상 주소를 물리 주소로 연결하는 방법(CPU는 가상 주소만 사용함)

#### 페이지를 사용하는 주소 맵핑

- 페이지: 일정 크기의 주소 공간 단위(가상 메모리를 일정 크기의 주소로 나눈 공간 단위)
- 페이지 테이블을 통해서 메모리에 접근
- 메인 메모리를 활용

#### 어소시어티브 메모리 페이지 표를 사용하는 주소 맵핑

- 페이지를 사용하는 주소 맵핑보다 빠름

#### 페이지 교체

- 블록들이 모두 사용중이면서 새로운 페이지가 필요할 때 페이지 교체가 필요
- CPU가 참조하는 페이지에 해당하는 블록이 없을 때 => 페이지 결함(Page Fault)
- 페이지 결함 발생 시 페이지 교체 전략에 따라 페이지를 교체함
  - FIFO
  - LRU: 가장 적게 참조된 페이지를 교체
    - 가장 적게 참조했으니 잘 안 쓰는 페이지이기 때문에 교체 => 가장 많이 쓰는 방법
    - 금방 교체된 페이지가 계속 교체되는 경우가 발생하는 문제가 있음 => 자원적으로 비효율 발생
    - age register를 통해서 이 문제를 해결함
  - LFU: 최근에 가장 많이 참조된 페이지를 교체
    - 사용을 많이 했으니 더 이상 사용하지 않을 것이기 때문에 교체

### 메모리 관리 하드웨어 (Memory Management Unit; MMU)

#### 기본적인 역할

- 논리 메모리 참조를 물리 메모리 주소로 변환, 동적 저장 장소 재배치
- 메모리 내에 서로 다른 사용자들이 하나의 프로그램을 공유하도록 지원
- 사용자의 허가되지 않은 접근을 방지
- 사용자가 운영체제의 기능을 변경하지 못하도록 정보를 보호

#### 동적 저장 장소 재배치(Dynamic Memory Relocation)

- 가상 메모리 시스템에서 페이지 크기를 가변적으로 운영 => 세그먼트
- 프로그램의 크기나 논리 구조의 용이성 제공
- 필요한 페이지를 메모리 공간에 이동, 병합

#### 세그먼트(Segment)

- 프로그램과 데이터를 세그먼트로 구분
- 여러 개의 페이지로 이루어지는 논리 공간
- 논리 주소: 세그먼트로 된 프로그램에 의하여 지정되는 주소

#### 멀티 프로그래밍 시스템

- 여러 사용자들 간의 프로그램 세그먼트 공유(예: OS 프로그램, 유틸리티 등)
- 논리 주소의 범위를 공유



OS는 자료구조를 잘 알아야 이해를 잘 할 수 있음

Array, Linked List, Stack, Queue 등의 자료 구조 개념이 등장하기 때문